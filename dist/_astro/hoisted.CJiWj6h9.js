import{T as S}from"./toastify.CHTvHrP4.js";import{a as l}from"./axios.B4uVmeYG.js";import"./hoisted.0hWJMduo.js";import"./_commonjsHelpers.Cpj98o6Y.js";function _e(){console.log("Hiding loading screen...");const e=document.getElementById("loading-screen-moreinfo");e.classList.remove("flex"),e.classList.add("hidden")}function Ne(){const e=document.getElementById("loading-screen-moreinfo");e.classList.remove("hidden"),e.classList.add("flex")}function Je(){console.log("Hiding loading screen...");const e=document.getElementById("loading-screen-two");e.classList.remove("flex"),e.classList.add("hidden")}function Ue(){const e=document.getElementById("loading-screen-two");e.classList.remove("hidden"),e.classList.add("flex")}const We=document.getElementById("search-form");We.addEventListener("submit",function(e){e.preventDefault();let o=new FormData(this).get("direccion");B=1,o===""&&S({text:"Introduce una dirección",duration:2500,destination:"https://github.com/apvarun/toastify-js",newWindow:!0,close:!1,gravity:"top",position:"center",stopOnFocus:!0,style:{borderRadius:"10px",background:"rgb(162,6,10)",backgroundImage:"linear-gradient(153deg, rgba(162,6,10,1) 2%, rgba(85,3,3,1) 89%)"},onClick:function(){}}).showToast(),A(o,B)});const Te=document.getElementById("search-data");let $="";const Pe=document.getElementById("prev-button"),He=document.getElementById("next-button"),ze=document.getElementById("page-info"),$e=document.getElementById("clear-form");let B=1,Le=1;const Me=10;A($,B);Pe.addEventListener("click",function(){B>1&&(B--,window.scrollTo({top:0,behavior:"auto"}),A($,B))});He.addEventListener("click",function(){B<Le&&(B++,window.scrollTo({top:0,behavior:"auto"}),A($,B))});$e.addEventListener("click",function(){document.getElementById("search-form").reset(),$="",A($,B)});function A(e,t){Ue(),l.get("https://estudiolucmar.com/backend/inmuebles/tabla.php",{params:{direccion:e,itemsPerPage:Me,page:t}}).then(function(o){console.log(o.data),Le=Math.ceil(o.data.totalItems/Me),Qe(o.data.data),Ye()}).catch(function(o){console.error("Error fetching JSON data:",o)})}function Qe(e){Te.innerHTML="",e.forEach(t=>{const o=document.createElement("tr");o.classList.add("border-b","border-zinc-300"),o.id="row-"+t.id,console.log("item",t.zona);function n(g,v){const L=document.createElement("td");return L.className=g,L.innerHTML=v,L}o.appendChild(n("text-center xl:text-start py-5 text-sm overflow-hidden w-[100%]",t.direccion)),o.appendChild(n("text-center xl:text-start py-5 text-sm overflow-hidden w-[100%]",t.zona)),o.appendChild(n("hidden xl:table-cell",t.tipo)),o.appendChild(n("hidden xl:table-cell",t.uso)),o.appendChild(n("hidden xl:table-cell",t.superficie)),o.appendChild(n("hidden xl:table-cell",t.ano_construccion));const a=document.createElement("td");a.className="xl:table-cell";const i=document.createElement("div");i.className="flex flex-row px-1 w-full h-full gap-2 justify-start items-center";const r=`<svg id="noticia-table-cell${t.id}" class="text-red-700 hidden" xmlns="http://www.w3.org/2000/svg" width="25px" height="25px" viewBox="0 0 20 20"><path fill="currentColor" d="M2.93 17.07A10 10 0 1 1 17.07 2.93A10 10 0 0 1 2.93 17.07M9 5v6h2V5zm0 8v2h2v-2z" /></svg>`,s=`<svg id="encargo-table-cell${t.id}" class="text-red-700 hidden" xmlns="http://www.w3.org/2000/svg" width="35px" height="35px" viewBox="0 0 20 20"><path fill="currentColor" d="M2 3a1 1 0 0 1 2 0h13a1 1 0 1 1 0 2H4v12.5a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm3 3.5a.5.5 0 0 1 .5-.5h11a.5.5 0 0 1 .5.5v7a2.5 2.5 0 0 1-2.5 2.5h-7A2.5 2.5 0 0 1 5 13.5zm3 7a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-2.55a1 1 0 0 0-.336-.748L11.332 8.13a.5.5 0 0 0-.664 0L8.336 10.2a1 1 0 0 0-.336.75z" /></svg>`;i.innerHTML=r+s,a.appendChild(i),o.appendChild(a);const c=document.createElement("td");c.className="relative";const p=document.createElement("div");p.classList="w-auto absolute top-1/2 -translate-y-1/2 right-3 xl:table-cell";const m=document.createElement("div");m.id=t.id,m.className="bg-slate-500 hover:bg-slate-900 w-[2em] h-[2em] rounded-lg flex flex-col items-center justify-center hover:rounded-3xl transition-all duration-[0.5s] ease-in-out hover:w-11 hover:h-11 overflow-hidden hover:cursor-pointer",m.onclick=function(){Ke(this)};const b='<svg class="p-2" id="more-info-button" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="#63E6BE" d="M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32V224H48c-17.7 0-32 14.3-32 32s14.3 32 32 32H192V432c0 17.7 14.3 32 32 32s32-14.3 32-32V288H400c17.7 0 32-14.3 32-32s-14.3-32-32-32H256V80z"/></svg>';m.innerHTML=b,p.appendChild(m),c.appendChild(p),o.appendChild(c),Te.appendChild(o),l.get("https://estudiolucmar.com/backend/inmuebles/inmueblemoreinfo.php?",{params:{id:t.id}}).then(g=>{const v=document.getElementById("row-"+t.id);g.data.inmueble.encargoState===1?document.getElementById("encargo-table-cell"+t.id).classList.remove("hidden"):(g.data.inmueble.encargoState===0||g.data.inmueble.encargoState===null)&&document.getElementById("encargo-table-cell"+t.id).classList.add("hidden"),g.data.inmueble.noticiastate===1?document.getElementById("noticia-table-cell"+t.id).classList.remove("hidden"):(g.data.inmueble.noticiastate===0||g.data.inmueble.noticiastate===null)&&document.getElementById("noticia-table-cell"+t.id).classList.add("hidden"),g.data.dataUpdateTime==="red"?v.classList.add("bg-red-100"):g.data.dataUpdateTime==="yellow"?v.classList.add("bg-yellow-100"):g.data.dataUpdateTime==="green"&&v.classList.add("bg-green-100")}).catch(g=>{console.error("Error fetching data:",g)})}),_e(),setTimeout(function(){Je()},500)}function Ye(){ze.textContent=`${B} de ${Le}`,Pe.disabled=B===1,He.disabled=B===Le}const Ge=document.getElementById("form-insertar-comentario"),ye=document.createElement("button");ye.id="enviar-comentario";ye.classList.add("p-3","text-sm","text-white","bg-green-800","hover:bg-green-600","rounded-md","transition-all","duration-[0.5s]","ease-in-out","hover:cursor-pointer","mb-4");ye.textContent="Enviar";Ge.appendChild(ye);function Ke(e){Ne(),l.get("https://estudiolucmar.com/backend/users/fetchusers.php",{withCredentials:!0}).then(P=>{console.log(P.data),P.data[0].admin===1?localStorage.setItem("currentAdmin",1):localStorage.setItem("currentAdmin",0)}).catch(P=>{console.error("Error fetching user data:",P)});let t="";console.log("ID:",e.id),t=e.id,localStorage.setItem("currentInmueble",t),K();const o=document.getElementById("more-info-container");o.classList.remove("hidden"),o.classList.add("flex"),o.classList.add("flex-col");const n=document.getElementById("tipo"),a=document.getElementById("uso"),i=document.getElementById("superficie"),r=document.getElementById("ano"),s=document.getElementById("direccion"),c=document.getElementById("form_id"),p=document.getElementById("comentarios-database-container"),m=document.getElementById("comentarioTextarea");document.getElementById("agregar-noticia-edit-more-info"),document.getElementById("encargos-container");const b=document.getElementById("potencialAdquisicion");b.classList.remove("flex"),b.classList.add("hidden");const g=document.getElementById("categoria");g.textContent="";const v=document.getElementById("edit-more-info");v.value=t,c.value=e.id;const L=c.value;console.log("el id oculto del input",L),p.innerHTML="",m.value="",n.textContent="",a.textContent="",i.textContent="",r.textContent="",s.textContent="",document.getElementById("comentarios-container");const V=document.getElementById("tipoPVA-texto"),q=document.getElementById("valoracion-texto"),f=document.getElementById("valoracionestablecida-texto"),J=document.getElementById("noticia-fecha-texto"),D=document.getElementById("prioridad-texto"),u=document.getElementById("comercial-texto"),I=document.getElementById("encargo-fecha-texto");I.textContent="";const N=document.getElementById("encargo-tipo-texto");N.textContent="";const _=document.getElementById("encargo-cliente-texto");_.textContent="";const T=document.getElementById("encargo-precio1-texto");T.textContent="";const C=document.getElementById("encargo-precio2-texto");C.textContent="";const oe=document.getElementById("encargo-comision-texto");oe.textContent="";const pe=document.getElementById("encargo-comercial-texto");pe.textContent="",V.textContent="",q.textContent="",f.textContent="",J.textContent="",D.textContent="",u.textContent="";function K(){l.get("https://estudiolucmar.com/backend/inmuebles/inmueblemoreinfo.php",{params:{id:t}}).then(P=>{console.log(P.data);let d=P.data;console.log("Responsable:",d.inmueble.responsable);const H=document.getElementById("responsable-texto");d.inmueble.responsable===null?H.innerHTML="No definido":H.textContent=d.inmueble.responsable,d.inmueble.responsable;const U=localStorage.getItem("currentInmueble"),W=localStorage.getItem("currentNoticiaState");localStorage.setItem("currentEncargoState",d.inmueble.encargoState);const Q=localStorage.getItem("currentEncargoState");if(W==="1"){const y=document.getElementById("encargocontainer");y.classList.remove("hidden"),y.classList.add("flex"),l.get("https://estudiolucmar.com/backend/noticias/noticiasfetch.php",{params:{id:U}}).then(E=>{console.log(E.data);let h=E.data;h.tipo_PV==="PV"?V.innerHTML=h.tipo_PV+"</br>Piso en Venta":h.tipo_PV==="PVA"&&(V.innerHTML=h.tipo_PV+"</br>Piso en Venta con Anterioridad"),console.log("data valoracion:",h.valoracion),h.valoracion=="1"?(q.innerHTML="Valoración<br>SÍ",f.classList.remove("hidden"),f.classList.add("flex"),f.innerHTML="Valoración establecida:<br>"+h.valoracion_establecida+"€"):h.valoracion=="0"&&(q.innerHTML="Valoración<br>NO",f.classList.remove("flex"),f.classList.add("hidden"));const k=Ie(h.noticia_fecha);J.textContent=k,D.innerHTML="Prioridad:<br>"+h.prioridad,u.innerHTML="Comercial:<br>"+h.comercial_noticia}).catch(E=>{console.error("Error fetching data:",E)})}else if(W==="0"){const y=document.getElementById("encargocontainer");y.classList.remove("flex"),y.classList.add("hidden")}if(Q==="1"){const y=document.getElementById("encargocontainer");y.classList.remove("hidden"),y.classList.add("flex"),l.get("https://estudiolucmar.com/backend/encargos/encargosfetch.php",{params:{id:U}}).then(E=>{let h=E.data;const k=Ie(h.encargo_fecha);I.innerHTML="Fecha: <br>"+k,N.innerHTML="Tipo de Encargo: <br>"+E.data.tipo_encargo;const we=E.data.cliente_id;l.get("https://estudiolucmar.com/backend/clientes/seleccionaClienteID.php",{params:{cliente_id:we}}).then(F=>{F.data.forEach(se=>{_.innerHTML="Cliente: <br>"+se.nombrecompleto_cliente})}).catch(F=>{console.error("Error fetching data:",F)}),T.innerHTML="Precio: <br>"+E.data.precio_1+"€",E.data.tipo_comision_encargo==="PORCENTAJE"?oe.innerHTML="Comisión: <br>"+E.data.comision_encargo+"%":E.data.tipo_comision_encargo==="FIJO"&&(oe.innerHTML="Comisión: <br>"+E.data.comision_encargo+"€"),E.data.precio_2===null?(C.classList.add("hidden"),C.innerHTML=""):(C.classList.remove("hidden"),C.innerHTML="Inmueble Rebajado: <br>"+E.data.precio_2+"€"),pe.innerHTML="Comercial: <br>"+E.data.comercial_encargo}).catch(E=>{console.error("Error:",E)})}else{const y=document.getElementById("encargocontainer");y.classList.remove("flex"),y.classList.add("hidden")}const ne=document.getElementById("comentarios-database-container"),fe=document.getElementById("comentarioTextarea"),M=d.comentarios,O=d.inmueble.direccion,z=d.inmueble.tipo,w=d.inmueble.uso,R=d.inmueble.superficie,ae=d.inmueble.ano_construccion;ne.innerHTML="",fe.value="",n.textContent=z,a.textContent=w,i.textContent=R,r.textContent=ae,s.textContent=O;const ce=document.getElementById("tipo-edit"),ie=document.getElementById("uso-edit"),de=document.getElementById("superficie-edit"),x=document.getElementById("ano-edit");ce.value=d.inmueble.tipo,ce.placeholder=d.inmueble.tipo,ie.value=d.inmueble.uso,ie.placeholder=d.inmueble.uso,de.value=d.inmueble.superficie,de.placeholder=d.inmueble.superficie,x.value=d.inmueble.ano_construccion,x.placeholder=d.inmueble.ano_construccion;const Ee=document.getElementById("categoria-edit");Ee.value=d.inmueble.categoria,Ee.placeholder=d.inmueble.categoria;const Y=document.getElementById("categoria"),re=document.getElementById("categoriacontainer");Y.textContent="",d.inmueble.categoria===null?(re.classList.add("hidden"),Y.classList.add("hidden")):(Y.classList.remove("hidden"),Y.textContent=d.inmueble.categoria);const be=document.getElementById("inquilino-photo"),X=document.getElementById("propietario-photo"),Be=document.getElementById("vacio-photo");d.inmueble.categoria==="Inquilino"?(be.classList.remove("hidden"),X.classList.add("hidden"),Be.classList.add("hidden")):d.inmueble.categoria==="Propietario"?(be.classList.add("hidden"),X.classList.remove("hidden"),Be.classList.add("hidden")):(be.classList.add("hidden"),X.classList.add("hidden"),Be.classList.remove("hidden"));const ve=document.getElementById("potencialAdquisicion");d.inmueble.potencial_adquisicion==="1"?(ve.classList.remove("hidden"),ve.classList.add("flex")):(ve.classList.remove("flex"),ve.classList.add("hidden"));const Fe=document.getElementById("form_id"),Re=document.getElementById("enviar-comentario");Re.onclick=function(){const y=Fe.value,E=fe.value;E===""?(S({text:"Introduce un comentario",duration:2500,destination:"https://github.com/apvarun/toastify-js",newWindow:!0,close:!1,gravity:"top",position:"center",stopOnFocus:!0,style:{borderRadius:"10px",background:"rgb(162,6,10)",background:"linear-gradient(153deg, rgba(162,6,10,1) 2%, rgba(85,3,3,1) 89%)"},onClick:function(){}}).showToast(),K()):(l.get("https://estudiolucmar.com/backend/comentarios/insertarcomentario.php?",{params:{id:y,comentario:E}}).then(h=>{console.log(h.data),S({text:"Comentario añadido",duration:2500,destination:"https://github.com/apvarun/toastify-js",newWindow:!0,close:!1,gravity:"top",position:"center",stopOnFocus:!0,style:{borderRadius:"10px",backgroundImage:"linear-gradient(to right top, #005d09, #0b6316, #146921, #1d6f2b, #247535, #267a39, #287e3d, #2a8341, #278740, #248b3f, #20903e, #1c943d)",textAlign:"center"},onClick:function(){}}).showToast(),A("",B),K()}).catch(h=>console.error("Error inserting comment:",h)),l.get("https://estudiolucmar.com/backend/inmuebles/inmueblemoreinfo.php",{params:{id:y}}).then(h=>{console.log(h.data.dataUpdateTime);const k=document.getElementById("row-"+y);console.log("el row elegiddo"+k.id),h.data.dataUpdateTime==="red"?(k.classList.remove("bg-green-100"),k.classList.remove("bg-yellow-100"),k.classList.add("bg-red-100")):h.data.dataUpdateTime==="yellow"?(k.classList.remove("bg-green-100"),k.classList.remove("bg-red-100"),k.classList.add("bg-yellow-100")):h.data.dataUpdateTime==="green"&&(k.classList.remove("bg-red-100"),k.classList.remove("bg-yellow-100"),k.classList.add("bg-green-100")),_e()}).catch(h=>{console.error("Error fetching data:",h)}))},M.forEach(y=>{const E=y.id,h=y.texto,k=y.date_time,we=Xe(k),F=document.createElement("div");if(F.classList.add("border-b","border-zinc-200","w-[100%]","relative","py-4","bg-zinc-200","rounded-md","px-5"),F.id=E,ne.appendChild(F),localStorage.getItem("currentAdmin")==="1"){const le=document.createElement("button");le.classList.add("absolute","right-0","-top-1","py-1.5","px-0","text-gray-800","transition-all","duration-[0.5s]","ease-in-out","hover:cursor-pointer","text-xs"),le.id=E;const G=document.createElementNS("http://www.w3.org/2000/svg","svg");G.classList.add("text-2xl","text-red-800"),G.setAttribute("xmlns","http://www.w3.org/2000/svg"),G.setAttribute("width","30px"),G.setAttribute("height","30px"),G.setAttribute("viewBox","0 0 20 20");const Ce=document.createElementNS("http://www.w3.org/2000/svg","path");Ce.setAttribute("fill","currentColor"),Ce.setAttribute("d","M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15l-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152l2.758 3.15a1.2 1.2 0 0 1 0 1.698"),G.appendChild(Ce),le.appendChild(G),F.appendChild(le),le.onclick=function(){l.get("https://estudiolucmar.com/backend/comentarios/deletecomment.php",{params:{id:E}}).then(Se=>{console.log(Se.data),S({text:"Comentario eliminado",duration:2500,destination:"https://github.com/apvarun/toastify-js",newWindow:!0,close:!1,gravity:"top",position:"center",stopOnFocus:!0,style:{borderRadius:"10px",backgroundImage:"linear-gradient(to right top, #c62828, #b92125, #ac1a22, #a0131f, #930b1c)",textAlign:"center"},onClick:function(){}}).showToast(),A("",B),K()}).catch(Se=>console.error("Error deleting comment:",Se))}}const se=document.createElement("p");se.classList.add("text-sm","text-gray-800","absolute","left-1.5","top-1.5"),se.textContent=we,F.appendChild(se);const ke=document.createElement("p");ke.classList.add("text-sm","text-gray-800","mt-4","overflow-hidden","whitespace-normal","text-justify"),ke.textContent=h,F.appendChild(ke)})}).catch(P=>console.error("Error fetching data:",P))}j(),te()}function Xe(e){const t=new Date(e);t.setHours(t.getHours()+2);const o=String(t.getDate()).padStart(2,"0"),n=String(t.getMonth()+1).padStart(2,"0"),a=t.getFullYear(),i=String(t.getHours()).padStart(2,"0"),r=String(t.getMinutes()).padStart(2,"0");return`${o} / ${n} / ${a} ${i}:${r}`}function Ie(e){const t=new Date(e),o=String(t.getDate()).padStart(2,"0"),n=String(t.getMonth()+1).padStart(2,"0"),a=t.getFullYear();return`${o}-${n}-${a}`}let me=!0,ue=!0,Z=!0;function j(){console.log("FETCH MORE INFO"),me=!0,ue=!0,Z=!0;const e=localStorage.getItem("currentInmueble"),t=document.getElementById("tipo"),o=document.getElementById("uso"),n=document.getElementById("superficie"),a=document.getElementById("ano"),i=document.getElementById("potencialAdquisicion"),r=document.getElementById("categoria");document.getElementById("enargos-container"),i.classList.remove("flex"),i.classList.add("hidden"),t.textContent="",o.textContent="",n.textContent="",a.textContent="",r.textContent="",l.get("https://estudiolucmar.com/backend/inmuebles/inmueblemoreinfo.php",{params:{id:e}}).then(s=>{console.log(s.data);let c=s.data;localStorage.setItem("currentNoticiaState",c.inmueble.noticiastate);const p=localStorage.getItem("currentNoticiaState");localStorage.setItem("currentEncargoState",c.inmueble.encargoState);const m=localStorage.getItem("currentEncargoState"),b=document.getElementById("tipoPVA-texto"),g=document.getElementById("valoracion-texto"),v=document.getElementById("valoracionestablecida-texto"),L=document.getElementById("noticia-fecha-texto"),V=document.getElementById("prioridad-texto"),q=document.getElementById("comercial-texto"),f=document.getElementById("encargos-container");if(b.textContent="",g.textContent="",v.textContent="",L.textContent="",V.textContent="",q.textContent="",p==="1"){l.get("https://estudiolucmar.com/backend/noticias/noticiasfetch.php",{params:{id:e}}).then(z=>{let w=z.data;console.log("Fetched data:",w),w.tipo_PV==="PV"?b.innerHTML=w.tipo_PV+"</br>Piso en Venta":w.tipo_PV==="PVA"&&(b.innerHTML=w.tipo_PV+"</br>Piso en Venta con Anterioridad"),console.log("data.valoracion:",w.valoracion),w.valoracion=="1"?(g.innerHTML="¿Valorado?<br>SÍ",v.classList.remove("hidden"),v.classList.add("flex"),v.innerHTML="Valoración establecida:<br>"+w.valoracion_establecida+"€"):w.valoracion=="0"&&(g.innerHTML="¿Valorado?<br>NO",v.classList.remove("flex"),v.classList.add("hidden"));const R=Ie(w.noticia_fecha);L.textContent=R,V.innerHTML="Prioridad:<br>"+w.prioridad,q.innerHTML="Comercial:<br>"+w.comercial_noticia}).catch(z=>{console.error("Error fetching data:",z)});const M=document.getElementById("noticiacontainer");document.getElementById("agregar-noticia-container");const O=document.getElementById("agregar-noticia-container-edit");M.classList.remove("hidden"),M.classList.add("flex"),O.classList.remove("flex"),O.classList.add("hidden"),f.classList.remove("hidden"),f.classList.add("flex")}else if(p==="0"){const M=document.getElementById("noticiacontainer");M.classList.remove("flex"),M.classList.add("hidden"),f.classList.remove("flex"),f.classList.add("hidden")}if(m==="1"){const M=document.getElementById("encargo-fecha-texto");M.textContent="";const O=document.getElementById("encargo-tipo-texto");O.textContent="";const z=document.getElementById("encargo-cliente-texto");z.textContent="";const w=document.getElementById("encargo-precio1-texto");w.textContent="";const R=document.getElementById("encargo-precio2-texto");R.textContent="";const ae=document.getElementById("encargo-comision-texto");ae.textContent="";const ce=document.getElementById("encargo-comercial-texto");ce.textContent="";const ie=document.getElementById("encargocontainer");ie.classList.remove("hidden"),ie.classList.add("flex"),l.get("https://estudiolucmar.com/backend/encargos/encargosfetch.php",{params:{id:e}}).then(x=>{x.data,console.log(x.data);const Ee=Ie(x.data.encargo_fecha);M.innerHTML="Fecha: <br>"+Ee,O.innerHTML="Tipo de Encargo: <br>"+x.data.tipo_encargo;const Y=x.data.cliente_id;console.log("clienteID",Y),l.get("https://estudiolucmar.com/backend/clientes/seleccionaClienteID.php",{params:{cliente_id:Y}}).then(re=>{re.data.forEach(X=>{console.log(X),z.innerHTML="Cliente: <br>"+X.nombrecompleto_cliente})}).catch(re=>{console.error("Error fetching data:",re)}),w.innerHTML="Precio: <br>"+x.data.precio_1+"€",x.data.tipo_comision_encargo==="PORCENTAJE"?ae.innerHTML="Comisión: <br>"+x.data.comision_encargo+"%":x.data.tipo_comision_encargo==="FIJO"&&(ae.innerHTML="Comisión: <br>"+x.data.comision_encargo+"€"),x.data.precio_2===null?(R.classList.add("hidden"),R.innerHTML=""):(R.classList.remove("hidden"),R.innerHTML="Inmueble Rebajado: <br>"+x.data.precio_2+"€"),ce.innerHTML="Comercial: <br>"+x.data.comercial_encargo}).catch(function(x){console.error("Error:",x)});const de=document.getElementById("agregar-encargo-container");de.classList.remove("flex"),de.classList.add("hidden")}else{const M=document.getElementById("encargo-database-container");M.classList.remove("flex"),M.classList.add("hidden");const O=document.getElementById("encargocontainer");O.classList.remove("flex"),O.classList.add("hidden")}const J=document.getElementById("responsable-texto");c.inmueble.responsable===null?J.innerHTML="No definido":J.textContent=c.inmueble.responsable;const D=document.getElementById("tipo-edit"),u=document.getElementById("uso-edit"),I=document.getElementById("superficie-edit"),N=document.getElementById("ano-edit"),_=document.getElementById("categoria-edit");_.value=c.inmueble.categoria,_.placeholder=c.inmueble.categoria;const T=document.getElementById("potencialAdquisicion"),C=document.getElementById("potencialAdquisicionEdit");c.inmueble.potencialAdquisicion===0?(console.log("Value is 0"),T&&C&&(T.classList.remove("flex"),T.classList.add("hidden"),C.checked=!1)):(console.log("Value is not 0"),T&&C&&(T.classList.remove("hidden"),T.classList.add("flex"),C.checked=!0)),D.value=c.inmueble.tipo,D.placeholder=c.inmueble.tipo,u.value=c.inmueble.uso,u.placeholder=c.inmueble.uso,I.value=c.inmueble.superficie,I.placeholder=c.inmueble.superficie,N.value=c.inmueble.ano_construccion,N.placeholder=c.inmueble.ano_construccion;const oe=document.getElementById("tipo"),pe=document.getElementById("uso"),K=document.getElementById("superficie"),P=document.getElementById("ano");oe.textContent=c.inmueble.tipo,pe.textContent=c.inmueble.uso,K.textContent=c.inmueble.superficie,P.textContent=c.inmueble.ano_construccion;const d=document.getElementById("categoria"),H=document.getElementById("categoriacontainer");d.textContent="";const U=document.getElementById("inquilino-photo"),W=document.getElementById("propietario-photo"),Q=document.getElementById("vacio-photo");c.inmueble.categoria==="Inquilino"?(H.classList.remove("hidden"),H.classList.add("flex"),d.classList.remove("hidden"),d.classList.add("flex"),U.classList.remove("hidden"),U.classList.add("block"),W.classList.add("hidden"),Q.classList.add("hidden"),d.innerHTML="Inquilino"):c.inmueble.categoria==="Propietario"?(H.classList.remove("hidden"),H.classList.add("flex"),d.classList.remove("hidden"),d.classList.add("flex"),U.classList.add("hidden"),W.classList.remove("hidden"),W.classList.add("block"),Q.classList.add("hidden"),d.innerHTML="Propietario"):c.inmueble.categoria==="Vacio"?(H.classList.remove("hidden"),H.classList.add("flex"),d.classList.remove("hidden"),d.classList.add("flex"),U.classList.add("hidden"),W.classList.add("hidden"),Q.classList.remove("hidden"),Q.classList.add("block"),d.innerHTML="Vacio"):c.inmueble.categoria===null&&(H.classList.remove("flex"),H.classList.add("hidden"),d.classList.remove("flex"),d.classList.add("hidden"),U.classList.add("hidden"),W.classList.add("hidden"),Q.classList.add("hidden"));const ne=document.getElementById("agregar-noticia-container-edit");c.inmueble.noticiastate===1&&(ge(),ne.classList.remove("flex"),ne.classList.add("hidden"));const fe=c.inmueble.responsable;localStorage.setItem("currentResponsable",fe),te()})}function Ze(){const e=document.getElementById("more-info-container");e.classList.remove("flex"),e.classList.add("hidden"),ee(),Ae(),xe(),Ne(),me=!0,ue=!0,Z=!0}const et=document.getElementById("cerrar-more-info");et.addEventListener("click",function(){Ze()});function tt(){me?nt():Ae(),me=!me}const ot=document.getElementById("toggle-comentarios");ot.addEventListener("click",function(){tt()});function nt(){const e=document.getElementById("comentarios-database-container");e.classList.remove("hidden"),e.classList.add("flex");const t=document.getElementById("form-insertar-comentario");t.classList.remove("hidden"),t.classList.add("flex");const o=document.getElementById("arrow-down");o.classList.remove("block"),o.classList.add("hidden");const n=document.getElementById("arrow-up");n.classList.remove("hidden"),n.classList.add("block")}function Ae(){const e=document.getElementById("comentarios-database-container");e.classList.remove("flex"),e.classList.add("hidden");const t=document.getElementById("form-insertar-comentario");t.classList.remove("flex"),t.classList.add("hidden");const o=document.getElementById("arrow-down");o.classList.remove("hidden"),o.classList.add("block");const n=document.getElementById("arrow-up");n.classList.remove("block"),n.classList.add("hidden")}function at(){ue?it():ee(),ue=!ue}const ct=document.getElementById("toggle-noticias");ct.addEventListener("click",function(){at()});function it(){const e=document.getElementById("arrow-down-noticias");e.classList.remove("block"),e.classList.add("hidden");const t=document.getElementById("arrow-up-noticias");t.classList.remove("hidden"),t.classList.add("block");const o=localStorage.getItem("currentNoticiaState"),n=document.getElementById("agregar-noticia-container"),a=document.getElementById("noticia-database-container");o==="1"?(n.classList.remove("flex"),n.classList.add("hidden"),a.classList.remove("hidden"),a.classList.add("flex")):o==="0"&&(n.classList.remove("hidden"),n.classList.add("flex"))}function ee(){const e=document.getElementById("agregar-noticia-container");e.classList.remove("flex"),e.classList.add("hidden");const t=document.getElementById("agregar-noticia-container-edit");t.classList.remove("flex"),t.classList.add("hidden");const o=document.getElementById("noticia-database-container");o.classList.remove("flex"),o.classList.add("hidden");const n=document.getElementById("arrow-down-noticias");n.classList.remove("hidden"),n.classList.add("block");const a=document.getElementById("arrow-up-noticias");a.classList.remove("block"),a.classList.add("hidden")}function Ve(){Z?rt():xe(),Z=!Z,console.log("Desplegar encargos:",Z)}const dt=document.getElementById("toggle-encargos");dt.addEventListener("click",function(){Ve()});function rt(){const e=document.getElementById("arrow-down-encargos");e.classList.remove("block"),e.classList.add("hidden");const t=document.getElementById("arrow-up-encargos");t.classList.remove("hidden"),t.classList.add("block");const o=localStorage.getItem("currentEncargoState"),n=document.getElementById("agregar-encargo-container"),a=document.getElementById("encargo-database-container");o==="1"?(n.classList.remove("flex"),n.classList.add("hidden"),a.classList.remove("hidden"),a.classList.add("flex")):(n.classList.remove("hidden"),n.classList.add("flex"),a.classList.remove("flex"),a.classList.add("hidden"))}function xe(){const e=document.getElementById("agregar-encargo-container");e.classList.remove("flex"),e.classList.add("hidden");const t=document.getElementById("agregar-encargo-container-edit");t.classList.remove("flex"),t.classList.add("hidden");const o=document.getElementById("encargo-database-container");o.classList.remove("flex"),o.classList.add("hidden");const n=document.getElementById("arrow-down-encargos");n.classList.remove("hidden"),n.classList.add("block");const a=document.getElementById("arrow-up-encargos");a.classList.remove("block"),a.classList.add("hidden")}function st(){const e=document.getElementById("extrainfocontainer-1");e.classList.remove("flex"),e.classList.add("hidden");const t=document.getElementById("extrainfocontainer-1-edit");t.classList.remove("hidden"),t.classList.add("flex");const o=document.getElementById("edit-more-info");console.log("Edit More Info Value:",o.value)}const lt=document.getElementById("show-edit-one");lt.addEventListener("click",function(){st()});function qe(){const e=document.getElementById("extrainfocontainer-1");e.classList.remove("hidden"),e.classList.add("flex");const t=document.getElementById("extrainfocontainer-1-edit");t.classList.remove("flex"),t.classList.add("hidden")}const mt=document.getElementById("hide-edit-one");mt.addEventListener("click",function(){qe()});function ut(){he();const e=document.getElementById("extrainfocontainer-2");e.classList.remove("flex"),e.classList.add("hidden");const t=document.getElementById("extrainfocontainer-2-edit");t.classList.remove("hidden"),t.classList.add("flex"),document.getElementById("edit-more-info")}const gt=document.getElementById("show-edit-two");gt.addEventListener("click",function(){ut()});function De(){const e=document.getElementById("extrainfocontainer-2");e.classList.remove("hidden"),e.classList.add("flex");const t=document.getElementById("extrainfocontainer-2-edit");t.classList.remove("flex"),t.classList.add("hidden")}const ht=document.getElementById("hide-edit-two");ht.addEventListener("click",function(){De()});function pt(){const e=document.getElementById("tipo-edit"),t=document.getElementById("uso-edit"),o=document.getElementById("superficie-edit"),n=document.getElementById("ano-edit"),a=document.getElementById("edit-more-info"),i=e.value,r=t.value,s=o.value,c=n.value,p=a.value,m=document.getElementById("loading-screen-moreinfo");m.classList.remove("hidden"),m.classList.add("flex"),l.get("https://estudiolucmar.com/backend/moreinfo/editMoreInfoOne.php",{params:{id:p,tipo:i,uso:r,superficie:s,ano_construccion:c}}).then(b=>{S({text:"Información actualizada",duration:2500,destination:"https://github.com/apvarun/toastify-js",newWindow:!0,close:!1,gravity:"top",position:"center",stopOnFocus:!0,style:{borderRadius:"10px",backgroundImage:"background-image: linear-gradient(to bottom right, var(--tw-gradient-stops))",backgroundColor:"#34D399",backgroundColor:"#047857"},onClick:function(){}}).showToast(),j(),qe()}).catch(b=>console.error("Error fetching JSON data:",b))}const ft=document.getElementById("edit-button-one");ft.addEventListener("click",function(){pt()});function Et(){let t=document.getElementById("edit-more-info").value;const n=document.getElementById("categoria-edit").value,i=document.getElementById("potencialAdquisicionEdit").checked?1:0;console.log("Potencial Adquisicion Edit Value:",i);const s=document.getElementById("responsable-edit").value,c=document.getElementById("loading-screen-moreinfo");c.classList.remove("hidden"),c.classList.add("flex"),l.get("https://estudiolucmar.com/backend/moreinfo/editMoreInfoTwo.php",{params:{id:t,categoria:n,potencialAdquisicion:i,responsable:s}}).then(p=>{S({text:"Información actualizada",duration:2500,destination:"https://github.com/apvarun/toastify-js",newWindow:!0,close:!1,gravity:"top",position:"center",stopOnFocus:!0,style:{borderRadius:"10px",backgroundImage:"linear-gradient(to right top, #005d09, #0b6316, #146921, #1d6f2b, #247535, #267a39, #287e3d, #2a8341, #278740, #248b3f, #20903e, #1c943d)"},onClick:function(){}}).showToast(),De(),j()}).catch(p=>console.error("Error fetching JSON data:",p))}const bt=document.getElementById("edit-button-two");bt.addEventListener("click",function(){Et()});function he(){l.get("https://estudiolucmar.com/backend/users/seleccionacomercial.php").then(e=>{let t=e.data;const o=document.getElementById("agregar-noticia-edit-comercial");o.innerHTML="";for(let n=0;n<t.length;n++){const a=document.createElement("option");a.value=t[n].nombrecompleto,a.text=t[n].nombrecompleto,o.appendChild(a)}}).catch(e=>console.error("Error fetching JSON data:",e)),l.get("https://estudiolucmar.com/backend/users/seleccionacomercial.php").then(e=>{let t=e.data;const o=document.getElementById("responsable-edit");o.innerHTML="";for(let a=0;a<t.length;a++){const i=document.createElement("option");i.value=t[a].nombrecompleto,i.text=t[a].nombrecompleto,o.appendChild(i)}const n=document.getElementById("responsable-edit");n.value=localStorage.getItem("currentResponsable"),n.placeholder=localStorage.getItem("currentResponsable")}).catch(e=>console.error("Error fetching JSON data:",e)),l.get("https://estudiolucmar.com/backend/users/seleccionacomercial.php").then(e=>{let t=e.data;const o=document.getElementById("agregar-encargo-edit-comercial");o.innerHTML="";for(let n=0;n<t.length;n++){const a=document.createElement("option");a.value=t[n].nombrecompleto,a.text=t[n].nombrecompleto,o.appendChild(a)}}).catch(e=>console.error("Error fetching JSON data:",e))}function Oe(){l.get("https://estudiolucmar.com/backend/clientes/seleccionaCliente.php").then(e=>{const t=e.data,o=document.getElementById("agregar-encargo-edit-cliente");o.innerHTML="",console.log(t),t.forEach(n=>{const a=document.createElement("option");a.value=n.id,a.text=n.nombrecompleto_cliente,o.appendChild(a)})}).catch(e=>console.error("Error fetching JSON data:",e))}function ge(){he();const e=document.getElementById("agregar-noticia-container");e.classList.remove("flex"),e.classList.add("hidden");const t=document.getElementById("agregar-noticia-container-edit");t.classList.remove("hidden"),t.classList.add("flex");const o=document.getElementById("edit-button-noticia-editar");o.classList.remove("flex"),o.classList.add("hidden");const n=document.getElementById("edit-button-noticia-eliminar");n.classList.remove("flex"),n.classList.add("hidden");const a=document.getElementById("edit-button-noticia");a.classList.remove("hidden"),a.classList.add("flex"),document.getElementById("valoracion-text").value="",document.querySelector('input[name="fecha-text"]').value="",document.getElementById("agregar-noticia-edit-comercial").innerHTML="";const i=document.querySelector('input[name="pv-pva"]:checked');i&&(i.checked=!1);const r=document.querySelector('input[name="valoracion"]:checked');r&&(r.checked=!1);const s=document.querySelector('input[name="prioridad"]:checked');s&&(s.checked=!1);const c=document.getElementById("hideNoticiaModoEdicion");c.classList.remove("absolute"),c.classList.add("hidden")}const vt=document.getElementById("agregar-noticia-container");vt.addEventListener("click",function(){ge()});function Lt(){he(),jt(),Oe();const e=document.getElementById("agregar-encargo-container");e.classList.remove("flex"),e.classList.add("hidden");const t=document.getElementById("agregar-encargo-container-edit");t.classList.remove("hidden"),t.classList.add("flex");const o=document.getElementById("hideEncargoModoEdicion");o.classList.remove("absolute"),o.classList.add("hidden");const n=document.getElementById("edit-button-encargo-editar");n.classList.remove("flex"),n.classList.add("hidden");const a=document.getElementById("edit-button-encargo-eliminar");a.classList.remove("flex"),a.classList.add("hidden");const i=document.getElementById("edit-button-encargo");i.classList.remove("hidden"),i.classList.add("flex"),document.getElementById("comision-encargo").value="",document.querySelector('input[name="fecha-encargo"]').value="",document.getElementById("agregar-encargo-edit-comercial").value="",document.getElementById("agregar-encargo-edit-cliente").value="",document.getElementById("precio-encargo").value="";const r=document.querySelector('input[name="tipo-encargo"]:checked');r&&(r.checked=!1);const s=document.querySelector('input[name="tipo-comision"]:checked');s&&(s.checked=!1);const c=document.getElementById("hideNoticiaModoEdicion");c.classList.remove("absolute"),c.classList.add("hidden")}const It=document.getElementById("agregar-encargo-container");It.addEventListener("click",function(){Lt()});function yt(){const e=document.getElementById("loading-screen-moreinfo");e.classList.remove("hidden"),e.classList.add("flex");const t=document.querySelector('input[name="pv-pva"]:checked'),o=document.querySelector('input[name="valoracion"]:checked'),n=document.getElementById("valoracion-text").value,a=document.querySelector('input[name="fecha-text"]').value,i=document.querySelector('input[name="prioridad"]:checked'),r=document.getElementById("agregar-noticia-edit-comercial").value,s=localStorage.getItem("currentInmueble");if(!t||!o||!a||!i||!r)return S({text:"No pueden haber campos vacíos",duration:2500,destination:"https://github.com/apvarun/toastify-js",newWindow:!0,close:!1,gravity:"top",position:"center",stopOnFocus:!0,style:{borderRadius:"10px",background:"rgb(162,6,10)",background:"linear-gradient(153deg, rgba(162,6,10,1) 2%, rgba(85,3,3,1) 89%)"},onClick:function(){}}).showToast(),te(),ge(),!1;{const c=t.value,p=o.value,m=i.value;if(p==="1"&&n==="")return S({text:"Intrduce valoración",duration:2500,destination:"https://github.com/apvarun/toastify-js",newWindow:!0,close:!1,gravity:"top",position:"center",stopOnFocus:!0,style:{borderRadius:"10px",background:"rgb(162,6,10)",background:"linear-gradient(153deg, rgba(162,6,10,1) 2%, rgba(85,3,3,1) 89%)"},onClick:function(){}}).showToast(),te(),ge(),!1;l.get("https://estudiolucmar.com/backend/noticias/agregarnoticia.php",{params:{id:s,tipoPVA:c,valoracion:p,valoraciontext:n,fecha:a,prioridad:m,comercial:r}}).then(b=>{S({text:"Noticia creada",duration:2500,destination:"https://github.com/apvarun/toastify-js",newWindow:!0,close:!1,gravity:"top",position:"center",stopOnFocus:!0,style:{borderRadius:"10px",backgroundImage:"background-image: linear-gradient(to bottom right, var(--tw-gradient-stops))",backgroundColor:"#34D399",backgroundColor:"#047857"},onClick:function(){}}).showToast(),A("",1),j(),ee(),console.log("Todo salio bien")}).catch(b=>console.error("Error fetching JSON data:",b))}}const xt=document.getElementById("edit-button-noticia");xt.addEventListener("click",function(){yt()});function Bt(){const e=document.getElementById("loading-screen-moreinfo");e.classList.remove("hidden"),e.classList.add("flex");const t=document.querySelector('input[name="tipo-encargo"]:checked'),o=document.getElementById("agregar-encargo-edit-comercial").value,n=document.getElementById("agregar-encargo-edit-cliente").value,a=document.querySelector('input[name="precio-encargo"]').value,i=document.querySelector('input[name="tipo-comision"]:checked'),r=document.querySelector('input[name="comision-encargo"]').value,s=document.querySelector('input[name="fecha-encargo"]').value,c=localStorage.getItem("currentInmueble");if(!t||!a||!i||!r||!s||!o||!n)return S({text:"No pueden haber campos vacíos",duration:2500,destination:"https://github.com/apvarun/toastify-js",newWindow:!0,close:!1,gravity:"top",position:"center",stopOnFocus:!0,style:{borderRadius:"10px",background:"rgb(162,6,10)",background:"linear-gradient(153deg, rgba(162,6,10,1) 2%, rgba(85,3,3,1) 89%)"},onClick:function(){}}).showToast(),te(),ge(),!1;{const p=t.value,m=document.querySelector('input[name="tipo-comision"]:checked').value;l.get("https://estudiolucmar.com/backend/encargos/agregarencargo.php",{params:{encargo_id:c,tipoEncargo:p,comercial:o,cliente:n,precio:a,tipoComision:m,comision:r,fecha:s}}).then(b=>{S({text:"Encargo creado",duration:2500,destination:"https://github.com/apvarun/toastify-js",newWindow:!0,close:!1,gravity:"top",position:"center",stopOnFocus:!0,style:{borderRadius:"10px",backgroundImage:"background-image: linear-gradient(to bottom right, var(--tw-gradient-stops))",backgroundColor:"#34D399",backgroundColor:"#047857"},onClick:function(){}}).showToast(),A($,B),Ve(),te(),j(),console.log("El encargo se ha añadido correctamente")}).catch(b=>console.error("Error fetching JSON data:",b))}}const wt=document.getElementById("edit-button-encargo");wt.addEventListener("click",function(){Bt()});function kt(){const e=document.getElementById("edit-button-noticia");e.classList.remove("flex"),e.classList.add("hidden");const t=document.getElementById("edit-button-noticia-editar");t.classList.remove("hidden"),t.classList.add("flex");const o=document.getElementById("edit-button-noticia-eliminar");o.classList.remove("hidden"),o.classList.add("flex");const n=document.getElementById("hideNoticiaModoEdicion");n.classList.remove("hidden"),n.classList.add("absolute");const a=document.getElementById("h2-agregar-noticia");a.textContent="Editar noticia",he();const i=document.getElementById("agregar-noticia-container-edit");i.classList.remove("hidden"),i.classList.add("flex");const r=document.getElementById("noticia-database-container");r.classList.remove("flex"),r.classList.add("hidden");const s=localStorage.getItem("currentInmueble"),c=document.getElementById("PV"),p=document.getElementById("PVA"),m=document.getElementById("radiosi"),b=document.getElementById("radiono"),g=document.getElementById("valoracion-text"),v=document.getElementById("alta"),L=document.getElementById("media"),V=document.getElementById("baja"),q=document.getElementById("fecha-text");g.value,document.querySelectorAll('input[name="prioridad"]').forEach(u=>{u.checked&&u.value}),document.querySelectorAll('input[name="valoracion"]').forEach(u=>{u.checked&&u.value}),document.querySelectorAll('input[name="pv-pva"]').forEach(u=>{u.checked&&u.value}),l.get("https://estudiolucmar.com/backend/noticias/noticiasfetch.php",{params:{id:s}}).then(u=>{let I=u.data;console.log("Fetched data:",I),document.getElementById("noticiacontainer"),I.tipo_PV==="PV"?c.checked=!0:I.tipo_PV==="PVA"&&(p.checked=!0),String(I.valoracion)==="1"?m.checked=!0:String(I.valoracion)==="0"?b.checked=!0:(m.checked=!1,b.checked=!1),q.value=I.noticia_fecha,g.value=I.valoracion_establecida,I.prioridad==="Alta"?v.checked=!0:I.prioridad==="Media"?L.checked=!0:I.prioridad==="Baja"&&(V.checked=!0);const N=document.getElementById("agregar-noticia-edit-comercial"),_=I.comercial_noticia,T=N.options;for(let C=0;C<T.length;C++)if(T[C].text===_){T[C].selected=!0;break}}).catch(u=>console.error("Error fetching JSON data:",u))}const Ct=document.getElementById("show-noticia-modo-edicion");Ct.addEventListener("click",function(){kt()});function St(){const e=document.getElementById("edit-button-encargo");e.classList.remove("flex"),e.classList.add("hidden");const t=document.getElementById("edit-button-encargo-editar");t.classList.remove("hidden"),t.classList.add("flex");const o=document.getElementById("edit-button-encargo-eliminar");o.classList.remove("hidden"),o.classList.add("flex");const n=document.getElementById("hideEncargoModoEdicion");n.classList.remove("hidden"),n.classList.add("absolute");const a=document.getElementById("h2-agregar-encargo");a.textContent="Editar encargo",he(),Oe();const i=document.getElementById("agregar-encargo-container-edit");i.classList.remove("hidden"),i.classList.add("flex");const r=document.getElementById("encargo-database-container");r.classList.remove("flex"),r.classList.add("hidden");const s=localStorage.getItem("currentInmueble"),c=document.getElementById("VENTA-encargo"),p=document.getElementById("ALQUILER-encargo"),m=document.getElementById("agregar-encargo-edit-cliente"),b=document.getElementById("precio-encargo"),g=document.getElementById("FIJO-encargo"),v=document.getElementById("PORCENTAJE-encargo"),L=document.getElementById("comision-encargo"),V=document.getElementById("fecha-encargo"),q=document.getElementById("agregar-encargo-edit-comercial");l.get("https://estudiolucmar.com/backend/encargos/encargosfetch.php",{params:{id:s}}).then(f=>{V.value=f.data.encargo_fecha,l.get("https://estudiolucmar.com/backend/clientes/seleccionaClienteID.php",{params:{cliente_id:f.data.cliente_id}}).then(u=>{const I=u.data[0].nombrecompleto_cliente,N=m.options;for(let _=0;_<N.length;_++)if(N[_].text===I){N[_].selected=!0;break}}).catch(function(u){console.error("Error:",u)});const J=f.data.comercial_encargo,D=q.options;for(let u=0;u<D.length;u++)if(D[u].text===J){D[u].selected=!0;break}b.value=f.data.precio_1,f.data.tipo_comision_encargo==="PORCENTAJE"?(v.checked=!0,L.value=f.data.comision_encargo):f.data.tipo_comision_encargo==="FIJO"&&(g.checked=!0,L.value=f.data.comision_encargo),f.data.tipo_encargo==="VENTA"?c.checked=!0:f.data.tipo_encargo==="ALQUILER"&&(p.checked=!0)}).catch(function(f){console.error("Error:",f)})}const Tt=document.getElementById("show-encargo-modo-edicion");Tt.addEventListener("click",function(){St()});function Mt(){ee();const e=document.getElementById("loading-screen-moreinfo");e.classList.remove("hidden"),e.classList.add("flex");const o=document.querySelector('input[name="pv-pva"]:checked').value,a=document.querySelector('input[name="valoracion"]:checked').value,r=document.getElementById("valoracion-text").value,c=document.querySelector('input[name="fecha-text"]').value,m=document.querySelector('input[name="prioridad"]:checked').value;console.log("prioridad:",m);const g=document.getElementById("agregar-noticia-edit-comercial").value,v=localStorage.getItem("currentInmueble");console.log(v),l.get("https://estudiolucmar.com/backend/noticias/updatenoticia.php",{params:{id:v,noticia_fecha:c,prioridad:m,tipo_PV:o,valoracion:a,valoracion_establecida:r,comercial:g}}).then(L=>{S({text:"Noticia editada correctamente",duration:2500,destination:"https://github.com/apvarun/toastify-js",newWindow:!0,close:!1,gravity:"top",position:"center",stopOnFocus:!0,style:{borderRadius:"10px",backgroundImage:"background-image: linear-gradient(to bottom right, var(--tw-gradient-stops))",backgroundColor:"#34D399",backgroundColor:"#047857"},onClick:function(){}}).showToast(),console.log("updateo correcto"),j()}).catch(L=>console.error("Error fetching JSON data:",L))}const _t=document.getElementById("edit-button-noticia-editar");_t.addEventListener("click",function(){Mt()});function Nt(){xe();const e=document.getElementById("loading-screen-moreinfo");e.classList.remove("hidden"),e.classList.add("flex");const o=document.querySelector('input[name="tipo-encargo"]:checked').value,n=document.getElementById("agregar-encargo-edit-comercial").value,a=document.getElementById("agregar-encargo-edit-cliente").value,i=document.querySelector('input[name="precio-encargo"]').value,r=document.querySelector('input[name="tipo-comision"]:checked'),s=document.querySelector('input[name="comision-encargo"]').value,c=document.querySelector('input[name="fecha-encargo"]').value,p=localStorage.getItem("currentInmueble");l.get("https://estudiolucmar.com/backend/encargos/updateEncargo.php",{params:{id:p,encargo_fecha:c,comercial_encargo:n,tipo_encargo:o,comision_encargo:s,cliente_id:a,precio_1:i,tipo_comision_encargo:r.value}}).then(m=>{S({text:"Encargo editado correctamente",duration:2500,destination:"https://github.com/apvarun/toastify-js",newWindow:!0,close:!1,gravity:"top",position:"center",stopOnFocus:!0,style:{borderRadius:"10px",backgroundImage:"background-image: linear-gradient(to bottom right, var(--tw-gradient-stops))",backgroundColor:"#34D399",backgroundColor:"#047857"},onClick:function(){}}).showToast(),console.log("Encargo editado correctamente"),j()}).catch(function(m){console.error("Error:",m)})}const Pt=document.getElementById("edit-button-encargo-editar");Pt.addEventListener("click",function(){Nt()});function Ht(){ee();const e=document.getElementById("loading-screen-moreinfo");e.classList.remove("hidden"),e.classList.add("flex");const t=localStorage.getItem("currentInmueble");l.get("https://estudiolucmar.com/backend/noticias/deletenoticia.php",{params:{id:t}}).then(o=>{S({text:"Noticia eliminada",duration:2500,destination:"https://github.com/apvarun/toastify-js",newWindow:!0,close:!1,gravity:"top",position:"center",stopOnFocus:!0,style:{borderRadius:"10px",backgroundImage:"background-image: linear-gradient(to bottom right, var(--tw-gradient-stops))",backgroundColor:"#34D399",backgroundColor:"#047857"},onClick:function(){}}).showToast(),A($,B),ee(),j()}).catch(o=>console.error("Error fetching JSON data:",o))}const At=document.getElementById("edit-button-noticia-eliminar");At.addEventListener("click",function(){Ht()});function Vt(){xe();const e=document.getElementById("loading-screen-moreinfo");e.classList.remove("hidden"),e.classList.add("flex");const t=localStorage.getItem("currentInmueble");l.get("https://estudiolucmar.com/backend/encargos/deleteEncargo.php",{params:{id:t}}).then(o=>{S({text:"Encargo eliminado correctamente",duration:2500,destination:"https://github.com/apvarun/toastify-js",newWindow:!0,close:!1,gravity:"top",position:"center",stopOnFocus:!0,style:{borderRadius:"10px",backgroundImage:"background-image: linear-gradient(to bottom right, var(--tw-gradient-stops))",backgroundColor:"#34D399",backgroundColor:"#047857"},onClick:function(){}}).showToast(),A($,B),j()}).catch(function(o){console.error("Error:",o)})}const qt=document.getElementById("edit-button-encargo-eliminar");qt.addEventListener("click",function(){Vt()});function Dt(){const e=document.getElementById("agregar-noticia-container-edit");e.classList.remove("flex"),e.classList.add("hidden");const t=document.getElementById("noticia-database-container");t.classList.remove("hidden"),t.classList.add("flex")}const Ot=document.getElementById("hideNoticiaModoEdicion");Ot.addEventListener("click",function(){Dt()});function Ft(){const e=document.getElementById("agregar-encargo-container-edit");e.classList.remove("flex"),e.classList.add("hidden");const t=document.getElementById("encargo-database-container");t.classList.remove("flex"),t.classList.add("hidden")}const Rt=document.getElementById("hideEncargoModoEdicion");Rt.addEventListener("click",function(){Ft()});function te(){console.log("Hiding loading screen...");const e=document.getElementById("loading-screen-moreinfo");e.classList.remove("flex"),e.classList.add("hidden")}function jt(){const e=document.getElementById("noticia-fecha-texto"),t=document.getElementById("fecha-encargo");if(e&&t){const o=e.textContent.trim(),n=o.split("-");if(n.length===3){const a=parseInt(n[0],10),i=parseInt(n[1],10)-1,r=parseInt(n[2],10),s=new Date(r,i,a);s.setDate(s.getDate()+1);const c=s.toISOString().split("T")[0];t.setAttribute("min",c)}else console.error("Invalid date format in fechaNoticia:",o)}else console.error('Element with id "noticia-fecha-texto" or "fecha-encargo" not found.')}
